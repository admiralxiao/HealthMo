# 安全落地任务清单（Backlog & 顺序）

更新时间：2026-01-30

---

## 1. 两周内必须完成（P0）
1) **订阅权威链路**（服务端验证 + entitlement）
- iOS：purchase → post backend
- backend：verify + store entitlement
- iOS：fetch entitlement + cache TTL
- Premium API：服务端校验

2) **C++ 交付加固**
- XCFramework
- strip symbols
- 去除可读字符串（关键字/规则）
- params_version 入参（防替换）

3) **止血开关**
- kill_switch.payments / kill_switch.vision / kill_switch.all（见 docs/12）
- iOS 行为：关闭入口/降级流程

---

## 2. 上线后 2–4 周（P1）
4) **App Attest / DeviceCheck 接入**
- 绑定关键接口（entitlement、vision、scores）
- 后端验证 assertion
- 风险评分 + 降级策略

5) **订阅通知（Server Notifications）**
- 订阅状态变更可回收权益
- 风控：trial 滥用检测

---

## 3. 中长期（P2）
6) 更强混淆/反篡改
7) 云端增强价值（Explain/趋势/个性化）
8) 水印与法务流程固化

---

## 4. “验收标准”（DoD）
- 用一份修改过的 IPA（或 hook 环境）尝试：
  - 本地显示 premium=true 但访问 explain API 被 403（服务端挡住）✅
- 订阅过期/退款后：
  - entitlement 在 24h 内回收 ✅
- C++ 库：
  - app 包内不含明显函数名/字符串关键字 ✅

---
